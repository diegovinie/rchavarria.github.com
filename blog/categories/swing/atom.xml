<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: swing | R. Chavarria's Blog]]></title>
  <link href="http://rchavarria.github.io/blog/categories/swing/atom.xml" rel="self"/>
  <link href="http://rchavarria.github.io/"/>
  <updated>2013-10-09T08:24:17+02:00</updated>
  <id>http://rchavarria.github.io/</id>
  <author>
    <name><![CDATA[Rub&eacute;n Chavarr&iacute;a]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Uso avanzado de SwingWorker]]></title>
    <link href="http://rchavarria.github.io/blog/2010/01/26/uso-avanzado-de-swingworker/"/>
    <updated>2010-01-26T09:44:00+01:00</updated>
    <id>http://rchavarria.github.io/blog/2010/01/26/uso-avanzado-de-swingworker</id>
    <content type="html"><![CDATA[<div style="margin:2%; padding:2%; background-color:#E0E0E0; ">
  <p>Este post pertenece a mi antiguo blog en <a href="http://rchavarria.wordpress.com">wordpress</a>, pero decidí pasarme a github:pages por las siguientes <a href="http://rchavarria.github.io/blog/2012/12/03/por-que-cambie-mi-blog-en-wordpress-com">razones</a></p>
</div>


<p>En una entrada anterior vimos cómo hacer un <a href="http://rchavarria.github.io/blog/2010/01/08/swingworker-en-java-5/">uso básico de SwingWorker</a> así como cuándo usarlo. Vimos que había dos métodos de recuperar el resultado de nuestros cálculos o tarea de larga duración.</p>

<p>Aquí veremos un uso avanzado de <code>SwingWorker</code>. Para ello realizaremos una sencilla aplicación que calcule los <strong>N</strong> primeros números de la serie de fibonacci, los vaya mostrando en un área de texto según los vaya calculando y mostraremos el progreso de la tarea un una barra de progreso.</p>

<!-- more -->


<p>La clase <code>SwingWorker</code> tiene la siguiente definición: <code>SwingWorker&lt;T, V&gt;</code>. En la entrada anterior vimos que la forma básica de recuperar el resultado de nuestros cálculos era a través del método <code>get()</code>, el cuál retorna un valor de tipo genérico <strong>T</strong>. El genérico <strong>V</strong> es el tipo de datos que admiten los métodos <code>publish</code> y <code>process</code> y es el tipo de datos en el que generaremos los resultados intermedios.</p>

<p>Para realizar nuestra tarea del cálculo de los números de fibonacci crearemos una clase <code>FibonacciWorker</code> que herede de <code>SwingWorker</code> y que haga uso de los métodos adecuados para notificar el progreso hecho en los cálculos. Esta notificación la haremos a través de eventos de cambios en una propiedad. Es posible utilizar <code>PropertyChangelListeners</code> con propiedades definidas por nosotros y utilizar el método <code>firePropertyChange</code> para lanzar estos eventos. Para este ejemplo utilizaremos la propiedad <code>progress</code> que es una propiedad que ya está enlazada por defecto. La propiedad <code>state</code> (indica el estado de la ejecución de la tarea: <em>INCIADA</em>, <em>CANCELADA</em>, <em>COMPLETADA</em>, ...) también lo está.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Nuestra tarea hereda de SwingWorker </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class FibonacciWorker extends SwingWorker&lt;List&lt;Integer&gt;, Integer&gt; {
</span><span class='line'>  PrimeNumbersTask(JTextArea textArea, int numbersToCalculate) {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>//initialize
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  }&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  @Override
</span><span class='line'>  public List&lt;Integer&gt; doInBackground() {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>while (numbers.size &amp;lt;= numberstoCalculate &amp;amp;&amp;amp; !isCancelled()) {
</span><span class='line'>  number = nextFibonacciNumber();
</span><span class='line'>  numbers.add(number);
</span><span class='line'>  publish(number);
</span><span class='line'>  setProgress(100 * numbers.size() / numbersToCalculate);
</span><span class='line'>}
</span><span class='line'>return numbers;
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  }&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  @Override
</span><span class='line'>  protected void process(List&lt;Integer&gt; chunks) {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>for (Integer number : chunks) {
</span><span class='line'>  textArea.append(number + &amp;quot;\n&amp;quot;);
</span><span class='line'>}
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  }&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  private Integer nextFibonacciNumber(){&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>//  calculate next fibonacci number and return it
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>En el código anterior se han omitido detalles de implementación para no desviar la atención. Del código anterior cabe destacar la llamada a <code>publish</code> en la línea <strong>11</strong>, la llamada a <code>setProgress</code> (línea <strong>12</strong>) y la implementación del método <code>process</code>.</p>

<p>Mediante la llamada al método <code>publish</code> indicamos a <code>SwingWorker</code> que vaya almacenando resultados intermedios con los cuales llamará al método <code>process</code>, el cual hemos sobrescrito y lo usaremos para mostrar esos resultados intermedios. Es muy importante recalcar que mientras el método <code>publish</code> se ejecuta en el hilo (thread) del cálculo exhaustivo, el método <code>process</code> se invoca en el <strong>Event Dispatching Thread (EDT)</strong>, y es por ello por lo que es seguro actualizar el interfaz de usuario.</p>

<p>Con la llamada al método <code>setProgress()</code> estamos indicando que se lance un evento de cambio sobre la propiedad <code>progress</code> (propiedad creada por defecto junto con <code>state</code> para la notificación de cambios en propiedades). El evento propagado incluirá entre sus datos el parámetro que recibe la función. Para mostrar ese progreso utilizaremos una barra de progreso, la cual la registraremos como interesada en recibir eventos de cambios en las propiedades de <code>FibonacciWorker</code>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Actualizar una barra de progreso </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>final JProgressBar progressBar = new JProgressBar(0, 100);
</span><span class='line'>FibonacciWorker task = new FibonacciWorker(textArea, numbersToCalculate);
</span><span class='line'>task.addPropertyChangeListener(
</span><span class='line'>  new PropertyChangeListener() {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>public  void propertyChange(PropertyChangeEvent evt) {
</span><span class='line'>  if ("progress".equals(evt.getPropertyName())) {
</span><span class='line'>    progressBar.setValue((Integer)evt.getNewValue());
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  });</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>En el siguiente enlace es posible ver una aplicación demostrando lo aprendido. Si se desea descargar el código fuente en forma de proyecto de NetBeans: <a href="http://kenai.com/projects/rchavarria/downloads/download/fibonacci%252FFibonacciCalculator%2520NB%2520project.zip"><strong>FibonacciWorker NetBeans project</strong></a>.</p>

<p><a href="http://kenai.com/projects/rchavarria/downloads/download/fibonacci%252Flaunch.jnlp"><img class="center" title="Ejecutar FibonacciCalculator" src="http://rchavarria.github.io/images/wordpress/launch.png" alt="" width="88" height="23" /></a></p>

<div id="_mcePaste" style="overflow:hidden;position:absolute;left:-10000px;top:285px;width:1px;height:1px;">http://rchavarria.wordpress.com/2010/01/08/swingworker-en-java-5/</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Uso de GridBagLayout (y II)]]></title>
    <link href="http://rchavarria.github.io/blog/2010/01/20/uso-de-gridbaglayout-y-ii/"/>
    <updated>2010-01-20T07:54:00+01:00</updated>
    <id>http://rchavarria.github.io/blog/2010/01/20/uso-de-gridbaglayout-y-ii</id>
    <content type="html"><![CDATA[<div style="margin:2%; padding:2%; background-color:#E0E0E0; ">
  <p>Este post pertenece a mi antiguo blog en <a href="http://rchavarria.wordpress.com">wordpress</a>, pero decidí pasarme a github:pages por las siguientes <a href="http://rchavarria.github.io/blog/2012/12/03/por-que-cambie-mi-blog-en-wordpress-com">razones</a></p>
</div>


<p>Antes de leer esta entrada deberías leer <a title="Uso de GridBagLayout (I)" href="http://rchavarria.github.io/blog/2009/12/21/uso-de-gridbaglayout-i" target="_self">Uso de GridBagLayout (I)</a>, si no lo has hecho ya.</p>

<p>Veamos algunos parámetros que nos permitirán configurar cómo se verán nuestros componentes con más flexibilidad que la conseguida con los parámetros vistos en el post anterior:</p>

<!-- more -->


<h2>fill</h2>

<p>Define la forma en la que el componente crecerá o no cuando se cambie el tamaño del panel al que pertenece. Los valores posibles están definidas como constantes en <code>GridBagConstraints</code> y son:</p>

<ul>
    <li><code>NONE</code>: valor por defecto. Indica que el componente no cambiará su tamaño.</li>
    <li><code>HORIZONTAL</code>: hará crecer el componente hasta completar el tamaño horizontal de la celda o celdas donde se encuentra el componente.</li>
    <li><code>VERTICAL</code>: igual que <code>HORIZONTAL</code> pero en sentido vertical.</li>
</ul>


<h2>anchor</h2>

<p>Este parámetro se utiliza cuando el componente es más pequeño que su área de dibujo - la celda o celdas donde yace el componente - e indica el lugar al que el componente quedará fijado cuando se modifique el tamaño del panel. Los valores están definidos como constantes en <code>GridBadConstraints</code>. Podemos ver los valores y el lugar donde el componente quedará fijado en la siguiente tabla:</p>

<div style="display: block; margin: 0 auto">
<table style="text-align:center;border:solid black;background-color:#f0f0f0;">
<tbody>
<tr>
<td>FIRST_LINE_START</td>
<td>PAGE_START</td>
<td>FIRST_LINE_END</td>
</tr>
<tr>
<td>LINE_START</td>
<td>CENTER</td>
<td>LINE_END</td>
</tr>
<tr>
<td>LAST_LINE_START</td>
<td>PAGE_END</td>
<td>LAST_LINE_END</td>
</tr>
</tbody>
</table>
</div>


<h2>weightx y weighty</h2>

<p>Estos parámetros especifican cómo distribuir el espacio entre las columnas - weightx -  y las filas - weighty -. Los valores que pueden tomar varían entre 0.0 y 1.0, siendo 1.0 el de más peso, lo que indicaría que ese componente ocuparía el mayor espacio posible. Si no se indica lo contrario, ambos parámetros toman el valor 0.0, lo que indica a <code>GridBagLayout</code> que el espacio extra al cambiar el tamaño al panel se dibujará entre el borde de las fila y columnas y el borde del contenedor, dejando un espacio libre entre ellos.</p>

<p>Ahora veamos el código que genera el panel con el gestor <code>GridBagLayout</code>:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Generando el panel </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>package es.rchavarria.gridbaglayouthowto;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>public class GridBagLayoutDemo extends javax.swing.JPanel {
</span><span class='line'>  public GridBagLayoutDemo() {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>initComponents();
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  }&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> private void initComponents() {
</span><span class='line'>   java.awt.GridBagConstraints gridBagConstraints;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   btn5 = new javax.swing.JButton();
</span><span class='line'>   btn1 = new javax.swing.JButton();
</span><span class='line'>   btn2 = new javax.swing.JButton();
</span><span class='line'>   btn4 = new javax.swing.JButton();
</span><span class='line'>   btn6 = new javax.swing.JButton();
</span><span class='line'>   btn3 = new javax.swing.JButton();&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   setLayout(new java.awt.GridBagLayout());&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   btn1.setText(&quot;btn 01&quot;);
</span><span class='line'>   add(btn1, new java.awt.GridBagConstraints());&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   btn2.setText(&quot;btn 02&quot;);
</span><span class='line'>   gridBagConstraints = new java.awt.GridBagConstraints();
</span><span class='line'>   gridBagConstraints.gridwidth = 2;
</span><span class='line'>   add(btn2, gridBagConstraints);&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   btn3.setText(&quot;btn 03&quot;);
</span><span class='line'>   gridBagConstraints = new java.awt.GridBagConstraints();
</span><span class='line'>   gridBagConstraints.gridx = 0;
</span><span class='line'>   gridBagConstraints.gridy = 1;
</span><span class='line'>   add(btn3, gridBagConstraints);&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   btn4.setText(&quot;btn 04&quot;);
</span><span class='line'>   gridBagConstraints = new java.awt.GridBagConstraints();
</span><span class='line'>   gridBagConstraints.gridx = 0;
</span><span class='line'>   gridBagConstraints.gridy = 2;
</span><span class='line'>   gridBagConstraints.fill = java.awt.GridBagConstraints.VERTICAL;
</span><span class='line'>   gridBagConstraints.anchor = java.awt.GridBagConstraints.SOUTH;
</span><span class='line'>   add(btn4, gridBagConstraints);&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   btn5.setText(&quot;btn 05&quot;);
</span><span class='line'>   gridBagConstraints = new java.awt.GridBagConstraints();
</span><span class='line'>   gridBagConstraints.gridx = 2;
</span><span class='line'>   gridBagConstraints.gridy = 3;
</span><span class='line'>   gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
</span><span class='line'>   add(btn5, gridBagConstraints);&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>   btn6.setText(&quot;large btn&quot;);
</span><span class='line'>   gridBagConstraints = new java.awt.GridBagConstraints();
</span><span class='line'>   gridBagConstraints.gridx = 1;
</span><span class='line'>   gridBagConstraints.gridy = 1;
</span><span class='line'>   gridBagConstraints.gridwidth = 2;
</span><span class='line'>   gridBagConstraints.gridheight = 2;
</span><span class='line'>   gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
</span><span class='line'>   gridBagConstraints.weightx = 1.0;
</span><span class='line'>   gridBagConstraints.weighty = 1.0;
</span><span class='line'>   add(btn6, gridBagConstraints);
</span><span class='line'> }&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> private javax.swing.JButton btn1;
</span><span class='line'> private javax.swing.JButton btn2;
</span><span class='line'> private javax.swing.JButton btn3;
</span><span class='line'> private javax.swing.JButton btn4;
</span><span class='line'> private javax.swing.JButton btn5;
</span><span class='line'> private javax.swing.JButton btn6;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Mediante las líneas del código del tipo: <code>add(componente, gridBagConstraint);</code> se especifican las restricciones para cada componente. Es posible utilizar el mismo objeto para especificar las restricciones pero es recomendable utilizar distintas instancias.</p>

<p>Para ver el resultado de este código, simplemente podemos probarlo mediante la siguiente clase:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Codigo de prueba </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>package es.rchavarria.gridbaglayouthowto;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>import javax.swing.JFrame;
</span><span class='line'>import javax.swing.SwingUtilities;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>public class RunDemo {
</span><span class='line'>public static void main(String[] args) {
</span><span class='line'>  SwingUtilities.invokeLater(new Runnable() {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>public void run() {
</span><span class='line'>  JFrame frm = new JFrame(&amp;quot;GridBagLayout HowTo&amp;quot;);
</span><span class='line'>  frm.getContentPane().add(new GridBagLayoutDemo());
</span><span class='line'>  frm.pack();
</span><span class='line'>  frm.setVisible(true);
</span><span class='line'>}
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  });
</span><span class='line'>}
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SwingWorker en Java 5]]></title>
    <link href="http://rchavarria.github.io/blog/2010/01/08/swingworker-en-java-5/"/>
    <updated>2010-01-08T19:44:00+01:00</updated>
    <id>http://rchavarria.github.io/blog/2010/01/08/swingworker-en-java-5</id>
    <content type="html"><![CDATA[<div style="margin:2%; padding:2%; background-color:#E0E0E0; ">
  <p>Este post pertenece a mi antiguo blog en <a href="http://rchavarria.wordpress.com">wordpress</a>, pero decidí pasarme a github:pages por las siguientes <a href="http://rchavarria.github.io/blog/2012/12/03/por-que-cambie-mi-blog-en-wordpress-com">razones</a></p>
</div>


<p>SwingWorker es una clase de utilidad incluida en Java SE 6 que soluciona el problema de utilizar un hilo (thread) separado al de Swing para realizar tareas de larga duración. Anteriormente ya existían implementaciones que realizaban esta tarea, pero en la versión 6 de Java SE se ha decidido incluirla en la propia distribución de Java. Existe un <a href="https://swingworker.dev.java.net/">backport de SwingWorker</a> para utilizar los mismos conceptos en Java SE 5. Esta entrada es aplicable tanto para SwingWorker incluido en Java SE 6 como para el backport.</p>

<!-- more -->


<h2>El hilo manejador de eventos (Event Dispatching Thread)</h2>

<p>Durante el desarrollo de interfaces gráficas suelen aparecer tareas cuya realización conllevan mucho tiempo, por ejemplo, leer un archivo XML cuando el usuario pulse un botón. La forma más rápida y sencilla de realizar esta tarea podría ser los siguiente:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>JButton button = new JButton(&quot;Cargar fichero XML&quot;);
</span><span class='line'>button.addActionListener(new ActionListener() {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>public void actionPerformed(ActionEvent e) {
</span><span class='line'>    xmlDocument = loadXML();
</span><span class='line'>}
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>});</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>De esta forma, la carga del archivo se realiza en el hilo manejador de eventos (EDT - Event Dispatching Thread) de Swing, y como la tarea necesita mucho tiempo, no es posible manejar el resto de eventos que la interfaz gráfica genera y se quedara congelado, fijo, sin respuesta aparente, hasta que la tarea finalice. Esto produce un efecto indeseable de cara al usuario de la aplicación.</p>

<p>De hecho, a la hora de desarrollar interfaces gráficas se deberían respetar estas dos reglas básicas:</p>

<ul>
    <li>Las tareas de larga duración no deben ejecutarse nunca en el hilo manejador de eventos (EDT), de otra forma la aplicación no responderá al usuario.</li>
    <li>Los componentes gráficos se deben acceder <em>únicamente </em>desde el hilo manejador de eventos.</li>
</ul>


<p>Cualquier otra debería realizarse en un hilo separado (difícil pero es lo más recomendable).</p>

<h2>Solución</h2>

<p>Efectivamente, la solución pasa por utilizar un hilo distinto al EDT. SwingWorker nos proporciona la base para utilizar un hilo distinto para realizar tareas costosas en cuanto al tiempo de ejecución. SwingWorker permite ejecutar tareas de larga duración mientras la interfaz gráfica sigue respondiendo a la interacción con el usuario.</p>

<p>La forma más simple de utilizar SwingWorker es implementando el método <em>doInBackground </em>extendiendo la clase SwingWorker o creando una clase anónima:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SwingWorker worker = new SwingWorker&lt;MyXMLFile, Void&gt;() {&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>public MyXMLFile doInBackground() {
</span><span class='line'>    MyXMLFile myXMLDoc = loadXML();
</span><span class='line'>    return myXMLDoc;
</span><span class='line'>}
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>};</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Para que la tarea se ejecute debemos invocar al método <em>execute</em> de SwingWorker. Dicho método se encarga de llamar a <em>doInBackground </em>asegurándose de que se ejecuta en un hilo diferente al EDT.</p>

<p>Pero, ¿cómo recupero el resultado de la larga tarea?. SwingWorker proporciona el método <em>get </em>para recuperar el resultado, pero sólo debe ser llamado una vez la tarea ha finalizado. Existen dos métodos para asegurarnos que la tarea ha finalizado:</p>

<ol>
    <li>Sobrescribiendo el método <em>done</em>, el cual es ejecutado en el hilo manejador de eventos después de que la tarea haya finalizado.
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>private MyXMLFile doc;
</span><span class='line'>//...
</span><span class='line'>SwingWorker&lt;Document, Void&gt; worker = new SwingWorker&lt;MyXMLFile, Void&gt;() {
</span><span class='line'>    public MyXMLFile doInBackground() {
</span><span class='line'>        MyXMLFile myXMLDoc = loadXML();
</span><span class='line'>        return myXMLDoc;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    public void done() {
</span><span class='line'>        doc = get();
</span><span class='line'>    }
</span><span class='line'>};</span></code></pre></td></tr></table></div></figure></notextile></div></li>
    <li>Registrar un <em>listener </em>mediante el método <em>addPropertyChangeListener(PropertyChangeListener listener)</em> el cual será notificado de cambios en el estado de SwingWorker.</span></li>
</ol>


<p><em>Actualización (26-01-2010)</em>: <a href="http://rchavarria.github.io/blog/2010/01/26/uso-avanzado-de-swingworker/">Uso avanzado de SwingWorker</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Uso de GridBagLayout (I)]]></title>
    <link href="http://rchavarria.github.io/blog/2009/12/21/uso-de-gridbaglayout-i/"/>
    <updated>2009-12-21T22:01:00+01:00</updated>
    <id>http://rchavarria.github.io/blog/2009/12/21/uso-de-gridbaglayout-i</id>
    <content type="html"><![CDATA[<div style="margin:2%; padding:2%; background-color:#E0E0E0; ">
  <p>Este post pertenece a mi antiguo blog en <a href="http://rchavarria.wordpress.com">wordpress</a>, pero decidí pasarme a github:pages por las siguientes <a href="http://rchavarria.github.io/blog/2012/12/03/por-que-cambie-mi-blog-en-wordpress-com">razones</a></p>
</div>


<p>En esta entrada veremos el uso básico de <code>GridBagLayout</code>, si se desea profundizar más en el tema se puede consultar la siguiente dirección: <a title="How to use GridBagLayout" href="http://java.sun.com/docs/books/tutorial/uiswing/layout/gridbag.html" target="_blank">How to use GridBagLayout</a>.</p>

<p><code>GridBagLayout</code> es uno de los gestores de layout que proporciona Java/Swing. En mi opinión es el gestor más flexible, pero también el más complejo, de hecho parece pensado para ser usado por constructores de interfaces gráficas, como por ejemplo Matisse para NetBeans.</p>

<!-- more -->


<p>Lo primero de todo veamos qué se puede conseguir con este gestor de layout:</p>

<p><img class="center /images/wordpress/gridbaglayout-frame1.png 250 142 Ventana usando" src="<code>GridBagLayout</code>"></p>

<p><code>GridBagLayout</code> coloca los componentes en una serie de filas y columnas, permite a los componentes ocupar varias filas y/o columnas y las filas y las columnas no tienen porque tener la misma altura o anchura. Finalmente, <code>GridBagLayout</code> calcula estas alturas y anchuras dependiendo de los atributos preferredSize de los componentes. En la siguiente imagen podemos el diseño de cada una de las celdas en las que se divide <code>GridBagLayout</code>:</p>

<p><img class="center" src="/images/wordpress/gridbaglayout-design.png" width="172" height="124" title="Diseñando un panel con GridBagLayout" ></p>

<p>Los componentes indican a <code>GridBagLayout</code> sus restricciones mediante un objeto del tipo <code>GridBagConstraints</code>. En esta primera entrada estudiaremos las restricciones básicas y dejaremos para la siguiente parámetros más avanzados que nos permitirán diseñar la posición y comportamiento de los componentes con máxima flexibilidad.</p>

<p><code>gridx</code> y <code>gridy</code>:
Indican la fila y la columna donde situar el componente. <code>gridx=0</code> y <code>gridy=0</code> indican la celda superior izquierda, mientras que, en nuestro ejemplo, <code>gridx=3</code> y <code>gridy=3</code> indican la celda inferior derecha.</p>

<p><code>gridwidth</code> y <code>gridheight</code>:
Indica el número de columnas o filas - respectivamente - que ocupa el componente. El valor por defecto es <code>1</code> y es posible que un componente ocupe varias filas y varias columnas a la vez, como por ejemplo <code>btn6</code>.</p>

<p><em>Actualización</em>: si te ha gustado, quizá deberías ver la segunda parte <a title="Uso de GridBagLayout (y II)" href="http://rchavarria.github.io/blog/2010/01/20/uso-de-gridbaglayout-y-ii" target="_self">Uso de GridBagLayout (y II)</a></p>
]]></content>
  </entry>
  
</feed>
